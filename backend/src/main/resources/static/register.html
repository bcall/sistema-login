<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; }
    .container { max-width: 400px; margin: 60px auto; background: #fff; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h2 { text-align: center; margin-bottom: 1.5rem; }
    label { display: block; margin-bottom: 0.5rem; }
    input[type="email"], input[type="password"] {
      width: 100%; padding: 0.5rem; margin-bottom: 1rem; border: 1px solid #ccc; border-radius: 4px;
    }
    button { width: 100%; padding: 0.7rem; background: #28a745; color: #fff; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; }
    button:hover { background: #218838; }
    .login-link { display: block; text-align: center; margin-top: 1rem; color: #007bff; text-decoration: none; }
    .login-link:hover { text-decoration: underline; }
    .error { color: #d8000c; background: #ffd2d2; padding: 0.5rem; border-radius: 4px; margin-bottom: 1rem; display: none; }
    @media (max-width: 500px) { .container { padding: 1rem; } }
  </style>
</head>
<body>
  <div class="container">
    <h2>Registro de Usuario</h2>
    <form id="registerForm" novalidate>
      <div class="error" id="registerError"></div>
      <label for="email">Correo electrónico</label>
      <input type="email" id="email" name="email" required autocomplete="username">
      <label for="password">Contraseña</label>
      <input type="password" id="password" name="password" required autocomplete="new-password">
      <label for="confirmPassword">Confirmar contraseña</label>
      <input type="password" id="confirmPassword" name="confirmPassword" required autocomplete="new-password">
      <button type="submit">Registrar</button>
    </form>
    <a class="login-link" href="login.html">¿Ya tienes cuenta? Inicia sesión</a>
  </div>
  <script>
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      const confirmPassword = document.getElementById('confirmPassword').value.trim();
      const errorDiv = document.getElementById('registerError');
      let errorMsg = '';
      if (!email) errorMsg = 'El correo electrónico es obligatorio.';
      else if (!password) errorMsg = 'La contraseña es obligatoria.';
      else if (!confirmPassword) errorMsg = 'Debes confirmar la contraseña.';
      else if (password !== confirmPassword) errorMsg = 'Las contraseñas no coinciden.';
      else if (password.length < 6) errorMsg = 'La contraseña debe tener al menos 6 caracteres.';
      if (errorMsg) {
        errorDiv.textContent = errorMsg;
        errorDiv.style.display = 'block';
        return;
      }
      errorDiv.style.display = 'none';
      
      fetch('/api/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: email, password: password })
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          errorDiv.style.display = 'none';
          alert(data.message);
          // Redirigir al login después del registro exitoso
          window.location.href = 'login.html';
        } else {
          errorDiv.textContent = data.message;
          errorDiv.style.display = 'block';
        }
      })
      .catch(error => {
        console.error('Error:', error);
        errorDiv.textContent = 'Error al conectar con el servidor';
        errorDiv.style.display = 'block';
      });
    });
  </script>
</body>
</html> 